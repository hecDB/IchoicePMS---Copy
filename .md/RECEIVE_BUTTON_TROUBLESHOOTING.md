# р╕Др╕╣р╣Ир╕бр╕╖р╕нр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓"

## ЁЯФ┤ р╕Ыр╕▒р╕Нр╕лр╕▓: р╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓" р╕Бр╕Фр╣Бр╕ер╣Йр╕зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Вр╕╢р╣Йр╕Щр╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓

## тЬЕ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В (Troubleshooting)

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╕Чр╕Фр╕кр╕нр╕Ър╕Ыр╕╕р╣Ир╕бр╕Фр╣Йр╕зр╕вр╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ър╕Юр╕┤р╣Ар╕ир╕й
1. **р╣Ар╕Ыр╕┤р╕Ф URL р╕Щр╕╡р╣Йр╣Гр╕Щр╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М:**
   ```
   http://localhost/IchoicePMS---Copy/test_receive_button.php
   ```

2. **р╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ъ:**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ "Database connected" р╣Бр╕кр╕Фр╕З тЬУ
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ "jQuery loaded" р╣Бр╕кр╕Фр╕З тЬУ
   - р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓ (Test Button)"

3. **р╣Ар╕Ыр╕┤р╕Ф Browser Console (F12) р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е:**
   - р╕Фр╕╣ "Console Output" р╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б
   - р╕Др╣Йр╕Щр╕лр╕▓ error messages (р╕кр╕╡р╣Бр╕Фр╕З)

---

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕▒р╣Ир╕зр╣Др╕Ы

#### **р╕Ыр╕▒р╕Нр╕лр╕▓ A: "API Error" р╕лр╕гр╕╖р╕н "404"**
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** р╣Др╕Яр╕ер╣М `get_po_items.php` р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╣Др╕Фр╣Й

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
```
р╣Ар╕Ыр╕┤р╕Ф: http://localhost/IchoicePMS---Copy/api/get_po_items.php?po_id=1

р╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е JSON р╣Ар╕Кр╣Ир╕Щ:
{
  "success": true,
  "items": [
    {
      "item_id": 1,
      "product_name": "Product A",
      ...
    }
  ]
}

р╕Цр╣Йр╕▓р╣Ар╕лр╣Зр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Фр╕З р╕лр╕гр╕╖р╕н error 404:
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣М api/get_po_items.php р╕бр╕╡р╕нр╕вр╕╣р╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕З (permissions)
- р╕Фр╕╣р╕Вр╕Щр╕▓р╕Фр╣Др╕Яр╕ер╣Мр╕зр╣Ир╕▓р╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
```

#### **р╕Ыр╕▒р╕Нр╕лр╕▓ B: "Modal shows but no items" (Modal р╕Вр╕╢р╣Йр╕Щр╣Бр╕Хр╣Ир╣Др╕бр╣Ир╣Ар╕лр╣Зр╕Щр╕кр╕┤р╕Щр╕Др╣Йр╕▓)**
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** Database query р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е

**р╕зр╕┤р╕Ир╕▒р╕вр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б:**
```bash
# р╣Гр╕Щр╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ъ р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕бр╣Бр╕ер╣Йр╕зр╣Ар╕Ыр╕┤р╕Ф Console (F12)
# р╕Фр╕╣ error message - р╕Др╕зр╕гр╣Бр╕кр╕Фр╕З error message р╕Ир╕▓р╕Б PHP

# р╕лр╕гр╕╖р╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в SQL:
SELECT 
    poi.item_id,
    p.name as product_name,
    p.sku,
    poi.qty as order_qty,
    COALESCE(SUM(ri.receive_qty), 0) as received_qty
FROM purchase_order_items poi
LEFT JOIN products p ON poi.product_id = p.product_id
LEFT JOIN receive_items ri ON poi.item_id = ri.item_id
WHERE poi.po_id = 13
GROUP BY poi.item_id;
```

#### **р╕Ыр╕▒р╕Нр╕лр╕▓ C: "TypeError" р╕лр╕гр╕╖р╕н "undefined"**
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** р╕Хр╕▒р╕зр╣Бр╕Ыр╕г JavaScript р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Др╕зр╣Й

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
- р╕гр╕╡р╣Ар╕Яр╕гр╕Кр╕лр╕Щр╣Йр╕▓ (Ctrl+F5) 
- р╣Ар╕бр╕╖р╣Ир╕нр╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б р╕Др╣Йр╕Щр╕лр╕▓ error р╣Гр╕Щ Console
- р╕Др╕▒р╕Фр╕ер╕нр╕Б error message р╣Ар╕Хр╣Зр╕бр╣Бр╕ер╣Йр╕зр╣Бр╕Бр╣Йр╣Др╕Вр╕Хр╕▓р╕бр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕кр╕Фр╕З

---

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ API Response Format

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╣Бр╕Бр╣Йр╣Др╕В `get_po_items.php` р╕Йр╕▒р╕Щр╣Др╕Фр╣Йр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е:

**р╕Бр╣Ир╕нр╕Щ (р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ):**
```json
{
  "success": true,
  "items": [
    {
      "order_qty": "100",      // String тЭМ
      "received_qty": "20",    // String тЭМ
      "unit_price": "150.50"   // String тЭМ
    }
  ]
}
```

**р╕лр╕ер╕▒р╕З (р╕Чр╕│р╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕з):**
```json
{
  "success": true,
  "items": [
    {
      "order_qty": 100,      // Number тЬУ
      "received_qty": 20,    // Number тЬУ
      "unit_price": 150.50   // Number тЬУ
    }
  ]
}
```

**р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:** р╣Ар╕Ыр╕┤р╕Ф `api/get_po_items.php?po_id=13` р╣Гр╕Щр╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М 
- р╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Др╕бр╣Ир╕бр╕╡ quote р╣Ар╕Кр╣Ир╕Щ `"qty": 100` р╣Др╕бр╣Ир╣Гр╕Кр╣И `"qty": "100"`

---

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕лр╕Щр╣Йр╕▓ receive_po_items.php

р╕Йр╕▒р╕Щр╣Др╕Фр╣Йр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З error handling р╣Гр╕Щр╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Й:

```javascript
// р╕Бр╣Ир╕нр╕Щ: р╕Вр╣Йр╕нр╕бр╕╣р╕е error р╣Др╕бр╣Ир╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ
error: function(xhr, status, error) {
    console.error('Error loading PO items:', error);
}

// р╕лр╕ер╕▒р╕З: р╣Бр╕кр╕Фр╕З HTTP Status Code р╣Бр╕ер╕░ Response Text
error: function(xhr, status, error) {
    console.error('AJAX Error - Status:', status, 'Error:', error);
    console.error('Response:', xhr.responseText);
    // р╣Бр╕кр╕Фр╕З error detail р╣Гр╕Щр╕лр╕Щр╣Йр╕▓р╕Ир╕нр╕Фр╣Йр╕зр╕в
}
```

---

## ЁЯОп Step-by-Step Debugging

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ 1: р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Фр╣Й `receive_po_items.php` р╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Фр╣Й `get_po_items.php` р╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В
3. р╕гр╕╡р╣Ар╕Яр╕гр╕Кр╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М (Ctrl+F5)

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ 2: р╕Чр╕Фр╕кр╕нр╕Ър╕Ыр╕╕р╣Ир╕б
1. р╣Ар╕Ыр╕┤р╕Ф `test_receive_button.php`
2. р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓"
3. р╣Ар╕Ыр╕┤р╕Ф Developer Tools (F12)
4. р╕Фр╕╣ Console tab р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е debug

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ 3: р╕Чр╕Фр╕кр╕нр╕Ър╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ир╕гр╕┤р╕З
1. р╣Ар╕Ыр╕┤р╕Ф `receive/receive_po_items.php`
2. р╕Др╣Йр╕Щр╕лр╕▓ PO р╕Чр╕╡р╣Ир╕бр╕╡р╕кр╕Цр╕▓р╕Щр╕░ "pending" р╕лр╕гр╕╖р╕н "partial"
3. р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓"
4. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕кр╕┤р╕Щр╕Др╣Йр╕▓

---

## ЁЯФН Advanced Debugging

### р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ р╣Гр╕лр╣Йр╣Ар╕Ыр╕┤р╕Ф Developer Console (F12):

```javascript
// р╕Чр╕Фр╕кр╕нр╕Ър╕зр╣Ир╕▓ jQuery р╕бр╕╡р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ
typeof $.ajax

// р╕Чр╕Фр╕кр╕нр╕Ър╕зр╣Ир╕▓ API р╕Хр╕нр╕Ър╕кр╕Щр╕нр╕З
fetch('api/get_po_items.php?po_id=1').then(r => r.json()).then(d => console.log(d))

// р╕Чр╕Фр╕кр╕нр╕Ъ event delegation
$(document).on('click', '.receive-po-btn', function() { console.log('clicked'); })
$('.receive-po-btn').click()  // р╕Ир╕│р╕ер╕нр╕Зр╕Бр╕▓р╕гр╕Др╕ер╕┤р╕Б
```

### р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М Logs
```bash
# р╕лр╕▓р╕Бр╣Гр╕Кр╣Й Apache р╕Ър╕Щ Windows:
dir "C:\Apache24\logs\"

# р╕Фр╕╣р╣Др╕Яр╕ер╣М error.log р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓ PHP errors
```

---

## ЁЯУЭ Files р╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В

| File | Changes |
|------|---------|
| `receive/receive_po_items.php` | тЬЕ р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З error handling р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕З HTTP Status Code р╣Бр╕ер╕░ Response Text |
| `api/get_po_items.php` | тЬЕ р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Ир╕▓р╕Б string р╣Ар╕Ыр╣Зр╕Щ numeric data type р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▒р╕зр╣Ар╕ер╕В |
| `test_receive_button.php` | тЬЕ р╣Др╕Яр╕ер╣Мр╕Чр╕Фр╕кр╕нр╕Ър╣Гр╕лр╕бр╣Ир╣Ар╕Юр╕╖р╣Ир╕нр╕зр╕┤р╕Щр╕┤р╕Ир╕Йр╕▒р╕вр╕Ыр╕▒р╕Нр╕лр╕▓ |

---

## тЬЕ р╣Ар╕бр╕╖р╣Ир╕нр╣Бр╕Бр╣Йр╣Др╕Вр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в р╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ:

1. **р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ test_receive_button.php:**
   - тЬУ Database connected
   - тЬУ jQuery loaded
   - тЬУ Bootstrap loaded
   - тЬУ [API Success Response] + items count

2. **р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ receive/receive_po_items.php:**
   - тЬУ р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б "р╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓"
   - тЬУ р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╣Ар╕Ыр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ
   - тЬУ р╕Хр╕▓р╕гр╕▓р╕Зр╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕кр╕┤р╕Щр╕Др╣Йр╕▓
   - тЬУ р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Бр╕гр╕нр╕Бр╕Ир╕│р╕Щр╕зр╕Щр╣Бр╕ер╕░р╕Ыр╕╕р╣Ир╕бр╕нр╕╖р╣Ир╕Щр╣Ж р╕Чр╕│р╕Зр╕▓р╕Щ

---

## ЁЯУЮ р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓

1. **р╕Др╕▒р╕Фр╕ер╕нр╕Б error message р╕Ир╕▓р╕Б Console (F12)**
2. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М error logs р╕Вр╕нр╕Зр╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М**
3. **р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б Network Inspector р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣ AJAX requests**
4. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣М `api/get_po_items.php` р╕бр╕╡р╕Вр╕Щр╕▓р╕Фр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╣Бр╕ер╕░р╣Др╕бр╣Ир╣Ар╕кр╕╡р╕вр╕лр╕▓р╕в**

---

**р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х:** 2025-12-03
**р╕кр╕Цр╕▓р╕Щр╕░:** ЁЯФз Debugging Guide v1.0

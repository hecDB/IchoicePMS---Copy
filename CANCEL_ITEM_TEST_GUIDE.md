# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö - ‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (2 ‡∏Å‡∏£‡∏ì‡∏µ)

## ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
```sql
-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡∏°‡πà
SELECT * FROM purchase_order_items 
WHERE item_id = [test_item_id] \G

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
is_cancelled
is_partially_cancelled
cancel_qty_reason
cancelled_by
cancelled_at
cancel_reason
cancel_notes
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á PO ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö:
‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ PO ‡∏ó‡∏µ‡πà‡∏°‡∏µ:
- ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏™‡∏±‡πà‡∏á: 100 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: pending ‡∏´‡∏£‡∏∑‡∏≠ partial
- ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡πâ‡∏≤‡∏á (‡πÄ‡∏ä‡πà‡∏ô 20-50 ‡∏´‡∏ô‡πà‡∏ß‡∏¢) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö partial cancellation

---

## Test Case 1: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" ‚Üí `/receive/receive_po_items.php`
2. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ PO ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "pending" ‡∏´‡∏£‡∏∑‡∏≠ "partial"
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" (üî∑ ‡∏ü‡πâ‡∏≤)
4. Modal ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á PO items
5. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (‡∏™‡∏µ‡πÅ‡∏î‡∏á) ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤

### Modal ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å:
```
‚úì ‡πÄ‡∏´‡πá‡∏ô "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" option
‚úì ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡πà‡∏á + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß
```

### ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
2. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‡πÄ‡∏ä‡πà‡∏ô "‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
3. **‡∏Å‡∏£‡∏≠‡∏Å** (optional): ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
4. **‡∏Ñ‡∏•‡∏¥‡∏Å**: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"

### ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:
```
‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
‚úÖ Modal ‡∏õ‡∏¥‡∏î
‚úÖ ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
```sql
SELECT 
    item_id, qty as ordered_qty,
    is_cancelled, cancel_qty_reason,
    cancelled_by, cancel_reason
FROM purchase_order_items 
WHERE item_id = [test_item_id];

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
is_cancelled = 1
cancel_qty_reason = [ordered_qty] -- (‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡πà‡∏á)
cancelled_by = [user_id]
cancel_reason = 'supplier_unavailable'
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö PO Status:
```sql
SELECT po_id, status 
FROM purchase_orders 
WHERE po_id = [test_po_id];

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
status = 'completed' ‚úÖ
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Receive Items:
```sql
SELECT SUM(receive_qty) as total_received
FROM receive_items 
WHERE item_id = [test_item_id];

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
total_received >= ordered_qty ‚úÖ
```

---

## Test Case 2: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô (‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô)

### ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
- ‡∏™‡∏±‡πà‡∏á: 100 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß: 60 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- ‡∏à‡∏∞‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å: 40 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- **‡∏£‡∏ß‡∏°**: 60 + 40 = 100 ‚úÖ (‡∏Ñ‡∏£‡∏ö)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
2. ‡πÄ‡∏õ‡∏¥‡∏î PO modal
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å

### Modal ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å:
```
‚úì ‡πÄ‡∏´‡πá‡∏ô "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" option
‚úì ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" (‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà)
```

### ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
2. **‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å** "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" **‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Ç‡∏∂‡πâ‡∏ô**
3. **‡∏Å‡∏£‡∏≠‡∏Å**: 40 (‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
4. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‡πÄ‡∏ä‡πà‡∏ô "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á"
5. **‡∏Ñ‡∏•‡∏¥‡∏Å**: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"

### ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:
```
‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 40 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
‚úÖ Modal ‡∏õ‡∏¥‡∏î
‚úÖ ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
```sql
SELECT 
    item_id, qty as ordered_qty,
    is_cancelled, is_partially_cancelled, 
    cancel_qty_reason, cancel_reason
FROM purchase_order_items 
WHERE item_id = [test_item_id];

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
is_cancelled = 0
is_partially_cancelled = 1 ‚úÖ
cancel_qty_reason = 40
cancel_reason = 'supplier_shortage'
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö PO Status:
```sql
SELECT 
    po.po_id, po.status,
    SUM(CASE WHEN ri.receive_qty > 0 THEN ri.receive_qty ELSE 0 END) as total_received,
    SUM(poi.cancel_qty_reason) as total_cancelled,
    SUM(poi.qty) as total_ordered
FROM purchase_orders po
LEFT JOIN purchase_order_items poi ON po.po_id = poi.po_id
LEFT JOIN receive_items ri ON poi.item_id = ri.item_id
WHERE po.po_id = [test_po_id]
GROUP BY po.po_id;

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
status = 'completed' ‚úÖ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ received + cancelled >= ordered)
total_received + total_cancelled >= total_ordered
```

---

## Test Case 3: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö)

### ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
- ‡∏™‡∏±‡πà‡∏á: 100 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß: 50 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- ‡∏à‡∏∞‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å: 30 ‡∏´‡∏ô‡πà‡∏ß‡∏¢
- **‡∏£‡∏ß‡∏°**: 50 + 30 = 80 (‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö) ‚ö†Ô∏è
- **‡∏Ñ‡πâ‡∏≤‡∏á**: 20 ‡∏´‡∏ô‡πà‡∏ß‡∏¢

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
2. ‡πÄ‡∏õ‡∏¥‡∏î PO modal
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å

### ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
2. **‡∏Å‡∏£‡∏≠‡∏Å**: 30 (‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
3. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**: ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•
4. **‡∏Ñ‡∏•‡∏¥‡∏Å**: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"

### ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:
```
‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 30 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
```sql
SELECT 
    poi.item_id, poi.qty as ordered_qty,
    is_partially_cancelled, cancel_qty_reason,
    SUM(ri.receive_qty) as total_received
FROM purchase_order_items poi
LEFT JOIN receive_items ri ON poi.item_id = ri.item_id
WHERE poi.item_id = [test_item_id]
GROUP BY poi.item_id;

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
is_partially_cancelled = 1
cancel_qty_reason = 30
total_received = 50
-- 50 + 30 = 80 < 100 (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö)
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö PO Status:
```sql
SELECT po.status 
FROM purchase_orders 
WHERE po_id = [test_po_id];

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
status = 'partial' ‚è≥ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô)
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á:
```sql
-- ‡∏Ñ‡πâ‡∏≤‡∏á = ordered - (received + cancelled)
SELECT 
    100 - (50 + 30) as remaining;

-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: 20 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡πâ‡∏≤‡∏á
```

---

## Test Case 4: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Input

### 4A: ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
```
‚úì ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"
‚úÖ ‡πÅ‡∏™‡∏î‡∏á error: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"
```

### 4B: ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•
```
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
‚úì ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•"
‚úÖ ‡πÅ‡∏™‡∏î‡∏á error: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•"
```

### 4C: ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏Å‡∏£‡∏ì‡∏µ partial)
```
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
‚úì ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Ç‡∏∂‡πâ‡∏ô
‚úì ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
‚úÖ ‡πÅ‡∏™‡∏î‡∏á error: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
```

### 4D: ‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 0 ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏•‡∏ö
```
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
‚úì ‡∏Å‡∏£‡∏≠‡∏Å: 0 ‡∏´‡∏£‡∏∑‡∏≠ -5
‚úì ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô"
‚úÖ ‡πÅ‡∏™‡∏î‡∏á error: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0"
```

### 4E: ‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á
```
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
‚úì ‡∏Å‡∏£‡∏≠‡∏Å: 150 (‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á 100)
‚úì ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô"
‚úÖ ‡πÅ‡∏™‡∏î‡∏á error: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠ 100"
```

---

## Test Case 5: UI Behavior

### 5A: ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô Quantity Input
```
‚úì ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£ ‚Üí ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ã‡πà‡∏≠‡∏ô
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" ‚Üí ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ã‡πà‡∏≠‡∏ô
‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" ‚Üí ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏≤‡∏Å‡∏è ‚úÖ
```

### 5B: ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Modal
```
‚úì ‡πÅ‡∏™‡∏î‡∏á "‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
‚úì ‡πÅ‡∏™‡∏î‡∏á "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á: [value]"
‚úì ‡πÅ‡∏™‡∏î‡∏á "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß: [value]"
‚úì ‡πÅ‡∏™‡∏î‡∏á "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å: [value]"
```

### 5C: Confirmation Message
```
‚úì "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" ‚Üí ‡πÅ‡∏™‡∏î‡∏á:
  "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î PO ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (100%)"

‚úì "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô [X]" ‚Üí ‡πÅ‡∏™‡∏î‡∏á:
  "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ X ‡∏´‡∏ô‡πà‡∏ß‡∏¢"
```

---

## Test Case 6: Activity Logs

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å:
```sql
SELECT 
    user_id, action, description, created_at
FROM activity_logs 
WHERE action = 'cancel_po_item'
ORDER BY created_at DESC
LIMIT 5;

-- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
action = 'cancel_po_item'
description = "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å PO XXX (cancel_all): ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•=..."
            ‡∏´‡∏£‡∏∑‡∏≠
           "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å PO XXX (cancel_partial): ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•=..."
```

---

## Test Case 7: Multiple Cancellations

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á:
```
PO ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö:
- ‡∏™‡∏±‡πà‡∏á: 100, ‡∏£‡∏±‡∏ö: 0

‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 1: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å 30
- database: is_partially_cancelled=1, cancel_qty_reason=30
- PO status: partial (‡∏£‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 70)

‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 2: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å 25 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏≠‡∏µ‡∏Å
- database: cancel_qty_reason=55 (‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ã‡πâ‡∏≥)
  ‡∏´‡∏£‡∏∑‡∏≠ create new record (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢)
- ‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏° + ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏ß‡∏° = 0 + 55 = 55
- PO status: partial (‡∏£‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 45)

‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 3: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å 45 (‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠)
- ‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏° + ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏ß‡∏° = 0 + 100 = 100
- PO status: completed ‚úÖ
```

---

## Test Case 8: Browser Console Logging

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console (F12 ‚Üí Console):
```javascript
// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
"Receive button clicked: {poId, poNumber, supplier, remark}"

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å cancel type:
// ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô:
// ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ error ‡∏™‡∏µ‡πÅ‡∏î‡∏á
```

---

## Quick Checklist

### ‚úÖ UI Changes:
- [ ] Modal ‡∏°‡∏µ radio buttons "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" / "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"
- [ ] ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
- [ ] ‡πÅ‡∏™‡∏î‡∏á "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á" ‡πÅ‡∏•‡∏∞ "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß"
- [ ] ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å

### ‚úÖ Functionality:
- [ ] ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí PO = completed
- [ ] ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô + ‡∏Ñ‡∏£‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‚Üí PO = completed
- [ ] ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô + ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‚Üí PO = partial
- [ ] ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á receive record (‡∏Å‡∏£‡∏ì‡∏µ cancel_all)

### ‚úÖ Database:
- [ ] is_partially_cancelled ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] cancel_qty_reason ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] cancelled_by, cancelled_at ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- [ ] cancel_reason, cancel_notes ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- [ ] activity_logs ‡∏°‡∏µ entry ‡πÉ‡∏´‡∏°‡πà

### ‚úÖ Status Updates:
- [ ] PO status ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
```
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö JavaScript
- ‡πÄ‡∏õ‡∏¥‡∏î Console (F12)
- ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ error ‡πÑ‡∏´‡∏°
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ event handler bind ‡∏ñ‡∏π‡∏Å
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: PO Status ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
```
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö updatePOStatus()
- ‡∏î‡∏π SQL query
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logic ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö total_items
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö condition ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à status
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≤‡∏î
```
‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö initializeCancelSchema()
- ALTER TABLE ‡∏≠‡∏≤‡∏à‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡πÄ‡∏á‡∏µ‡∏¢‡∏ö ‡πÜ
- ‡∏î‡∏π MySQL error log
- ‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
```

---

## Contact & Support

‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console error
- ‡∏î‡∏π Database logs
- ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö PHP error logs

---

**Status**: ‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö  
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô**: 1.0  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà**: December 3, 2025
